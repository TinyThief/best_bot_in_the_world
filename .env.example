# Bybit API (храни в .env, не коммить ключи)
BYBIT_API_KEY=
BYBIT_API_SECRET=

# Testnet: true = тестовая сеть, false = боевая
BYBIT_TESTNET=true

# Торговый режим: linear (USDT-M), inverse, spot
BYBIT_CATEGORY=linear

# Пара для торговли
SYMBOL=BTCUSDT

# Таймфреймы через запятую (минуты: 1,3,5,15,30,60,120,240,360,720 или D,W,M)
TIMEFRAMES=15,60,240

# Минимальный score фазы (0..1). Детектор даёт 0.6–0.7 для уверенных фаз; 0.8+ только у капитуляции.
PHASE_SCORE_MIN=0.6
# Ниже этого score фаза считается неясной (phase_unclear). Минимальный разрыв между основной и второй фазой (score_gap).
PHASE_UNCLEAR_THRESHOLD=0.5
PHASE_MIN_GAP=0.1
# Устойчивость фазы: доля последних тиков с той же фазой (0..1). Размер истории по ТФ (число тиков).
PHASE_STABILITY_MIN=0.6
PHASE_HISTORY_SIZE=5

# Тренд (модуль market_trend): минимальная сила (0..1), порог неясности, минимальный разрыв
TREND_STRENGTH_MIN=0.35
TREND_UNCLEAR_THRESHOLD=0.3
TREND_MIN_GAP=0.08

# Фильтры входа: 0 = отключено. VOLUME_MIN_RATIO — мин. объём относительно MA(20). ATR_MAX_RATIO — макс. ATR/MA(ATR).
VOLUME_MIN_RATIO=0
ATR_MAX_RATIO=0
# Минимум ТФ, совпадающих по тренду и фазе с направлением входа (1 = только старший, 2+ = консенсус)
TF_ALIGN_MIN=1
# Устойчивость тренда: доля последних тиков с тем же направлением (0 = не проверять)
TREND_STABILITY_MIN=0
# Уровни: вход только если цена в пределах N (доля, 0.02 = 2%) от свинг-уровня. 0 = не проверять
LEVEL_MAX_DISTANCE_PCT=0
# Режим рынка (тренд/диапазон/всплеск): 1 = не входить при режиме «всплеск» по старшему ТФ
REGIME_BLOCK_SURGE=1
# Единый score входа (0..1): веса фазы, тренда и совпадения ТФ (сумма любая — нормализуется)
ENTRY_SCORE_WEIGHT_PHASE=0.4
ENTRY_SCORE_WEIGHT_TREND=0.35
ENTRY_SCORE_WEIGHT_TF_ALIGN=0.25
# Качество свечей: мин. quality_score (0..1) для использования ТФ; 0 = не проверять
CANDLE_QUALITY_MIN_SCORE=0

# Источник свечей для анализа: db — из БД (меньше запросов), exchange — каждый тик с биржи
DATA_SOURCE=db
# Минимальная уверенность сигнала (0..1) для фильтра «торговый» сигнал; 0 — не фильтровать
SIGNAL_MIN_CONFIDENCE=0
# Ретраи запросов к Bybit: макс попыток, задержка (с) при rate limit / сбое
EXCHANGE_MAX_RETRIES=5
EXCHANGE_RETRY_BACKOFF_SEC=1

# --- База для обучения (накопление свечей) ---
# Путь к SQLite (каталог создаётся сам)
DB_PATH=data/klines.db
# Все таймфреймы для БД: 1,3,5,15,30,60,120,240,360,720,D,W,M
TIMEFRAMES_DB=1,3,5,15,30,60,120,240,360,720,D,W,M
# Сколько свечей вглубь загружать при первом бэкфилле на каждый ТФ
BACKFILL_MAX_CANDLES=50000
# Как часто дотягивать новые свечи (секунды)
DB_UPDATE_INTERVAL_SEC=60
# При старте бота автоматически углублять историю по всем ТФ до упора (1=да, 0=нет)
AUTO_EXTEND_AT_STARTUP=1

# --- Логирование ---
# Каталог логов (пусто = проект/logs). bot.log — всё, signals.log — компактные строки по каждому сигналу
LOG_DIR=
# Уровень: DEBUG, INFO, WARNING, ERROR. LOG_LEVEL_FILE — для файла (по умолчанию как LOG_LEVEL)
LOG_LEVEL=INFO
# Макс. размер одного файла (МБ), число старых файлов при ротации
LOG_FILE_MAX_MB=10
LOG_BACKUP_COUNT=7
# Писать ли отдельно signals.log (1/0)
LOG_SIGNALS_FILE=1

# --- Telegram (управление ботом) ---
# Токен от @BotFather
TELEGRAM_BOT_TOKEN=
# Разрешённые user id через запятую (пусто = все). Узнать id: /id в боте
TELEGRAM_ALLOWED_IDS=
